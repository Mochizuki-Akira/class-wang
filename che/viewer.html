<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>講義ファイル閲覧｜学習小屋</title>
  <link rel="stylesheet" href="../common/style.css" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #111;
      color: #eee;
      font-family: "Hiragino Kaku Gothic ProN", sans-serif;
    }

    body {
      display: flex;
      flex-direction: column;
    }

    /* 顶部返回按钮 */
    .overlay {
      position: fixed;
      top: 14px;
      left: 14px;
      z-index: 50;
    }
    .btn {
      display: inline-block;
      padding: 8px 14px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      text-decoration: none;
      font-size: 14px;
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(4px);
      transition: background 0.2s;
    }
    .btn:hover {
      background: rgba(255,255,255,.2);
    }

    /* 主容器 */
    #main {
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      padding-top: 56px; /* 给返回按钮留空间 */
    }

    /* PDF 区域 */
    #pdfFrame {
      width: 100%;
      height: calc(100vh - 56px);
      border: none;
      background: #222;
    }

    /* 错误信息 */
    #error {
      text-align: center;
      padding: 80px 16px 16px;
      font-size: 0.95rem;
      color: #f3f3f3;
    }
  </style>
</head>

<body>
  <!-- 顶部返回 -->
  <div class="overlay">
    <a id="backBtn" class="btn">← 一覧に戻る</a>
  </div>

  <div id="main">
    <div id="error" style="display:none;"></div>
    <iframe id="pdfFrame"></iframe>
  </div>

  <script>
    // === 文件映射表 ===
    const FILES = {
      '2510_1': 'assets/lectures/2510/chem_1.pdf',
      '2510_2': 'assets/lectures/2510/chem_2.pdf',
      '2510_3': 'assets/lectures/2510/chem_3.pdf',
      '2510_hw1': 'assets/lectures/2510/hw_1.pdf',
      '2510_hw2a': 'assets/lectures/2510/hw_2a.pdf',
      '2510_hw2b': 'assets/lectures/2510/hw_2b.pdf',
      '2510_hw3': 'assets/lectures/2510/hw_3.pdf'
    };

    const qs = new URLSearchParams(location.search);
    const id = qs.get('id') || '';
    const path = FILES[id];

    const backBtn = document.getElementById('backBtn');
    const pdfFrame = document.getElementById('pdfFrame');
    const errorBox = document.getElementById('error');

    // === 返回目标自动识别 ===
    let back = './lectures.html';
    const ref = document.referrer || '';
    if (ref.includes('list-2507.html')) back = './list-2507.html';
    else if (ref.includes('list-2510.html')) back = './list-2510.html';
    else if (/^2507_/.test(id)) back = './list-2507.html';
    else if (/^2510_/.test(id)) back = './list-2510.html';
    backBtn.href = back;

    // === 设置 PDF ===
    if (!path) {
      // 没有对应文件
      pdfFrame.style.display = 'none';
      errorBox.style.display = 'block';
      errorBox.textContent = '❌ 対象のPDFが見つかりません。URLの「id」パラメータを確認してください。';
    } else {
      document.title = `講義ファイル (${id})｜学習小屋`;
      // 直接使用浏览器 PDF 显示功能（自带下载按钮等）
      pdfFrame.src = path;
    }
  </script>
</body>
</html>