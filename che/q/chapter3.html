<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>第3章 化学反応と熱・光・平衡</title>
  <style>
    body { font-family: sans-serif; line-height: 1.6; padding: 20px; background: #f8f8f8; }
    h1, h2 { color: #003366; }
    .section { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 0 5px #ccc; }
    .question { margin: 10px 0; }
    .options label { margin-right: 10px; }
    .result { display: inline-block; margin-left: 10px; font-weight: bold; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; }
    #codeArea { margin-top: 20px; font-size: 18px; }
  </style>
</head>
<body>
  <h1>第3章 化学反応と熱・光・平衡</h1>

  <form id="quizForm">
    <div class="section">
      <h2>化学反応と熱・光</h2>
      <script>
        const thermoQuestions = [6,1,3,2,5, 3,4,5,3,4, 6,2];
        for (let i = 0; i < thermoQuestions.length; i++) {
          const qn = i + 1;
          document.write(`<div class="question">問${qn}：<span class="options">`);
          for (let j = 1; j <= 6; j++) {
            document.write(`<label><input type="radio" name="t${qn}" value="${j}">${j}</label>`);
          }
          document.write(`</span><span class="result" id="r-t${qn}"></span></div>`);
        }
      </script>
    </div>

    <div class="section">
      <h2>反応速度・化学平衡</h2>
      <script>
        const balanceQuestions = [3,1,5,3,1, 6,5,4,3,4, 2,2,6];
        for (let i = 0; i < balanceQuestions.length; i++) {
          const qn = i + 13;
          document.write(`<div class="question">問${qn}：<span class="options">`);
          for (let j = 1; j <= 6; j++) {
            document.write(`<label><input type="radio" name="b${qn}" value="${j}">${j}</label>`);
          }
          document.write(`</span><span class="result" id="r-b${qn}"></span></div>`);
        }
      </script>
    </div>

    <button type="submit">答え合わせ</button>
  </form>

  <div id="codeArea">
    あなたの確認コード：<code id="resultCode">（まだ生成されていません）</code>
  </div>

  <script>
    const answers = {};
    const thermo = [6,1,3,2,5, 3,4,5,3,4, 6,2];
    const balance = [3,1,5,3,1, 6,5,4,3,4, 2,2,6];
    thermo.forEach((val, i) => answers[`t${i+1}`] = val);
    balance.forEach((val, i) => answers[`b${i+13}`] = val);

    document.getElementById('quizForm').addEventListener('submit', function (e) {
      e.preventDefault();
      let binaryString = '';
      for (const key in answers) {
        const selected = document.querySelector(`input[name="${key}"]:checked`);
        const result = document.getElementById(`r-${key}`);
        if (selected) {
          if (parseInt(selected.value) === answers[key]) {
            result.textContent = '✅';
            result.style.color = 'green';
            binaryString += '1';
          } else {
            result.textContent = '❌';
            result.style.color = 'red';
            binaryString += '0';
          }
        } else {
          result.textContent = '未選択';
          result.style.color = 'gray';
          binaryString += '0';
        }
      }
      const encodedBinary = '1' + binaryString;
      const decimalCode = BigInt('0b' + encodedBinary).toString();
      document.getElementById('resultCode').textContent = decimalCode;
    });
  </script>
</body>
</html>
